<h1><%= @campaign.title %></h1>
<p><%= @campaign.description %></p>
<p>Goal: <%= number_to_currency(@campaign.goal) %></p>
<p>End Date: <%= @campaign.end_date.strftime("%Y-%b-%d %H:%m") %></p>
<p>Address: <%= @campaign.address %></p>

<p><span class="label <%= label_class(@campaign.aasm_state) %>"><%= @campaign.aasm_state.capitalize %></span></p>
<%# may_publish? is a method generated by AASM that will tell you if you're able to publish a
  campaign based on the rules defined in the Campaign AASM %>
<% if @campaign.may_publish? %>
  <%= link_to "Publish", campaign_publishings_path(@campaign),
              method: :post,
              data:   {confirm: "Are you sure you want to publish?"},
              class:  "btn btn-primary" %>
<% end %>

<%= link_to "Edit", edit_campaign_path(@campaign), class: "btn btn-info" %>
<%= link_to "Delete", @campaign, class: "btn btn-danger" %>

<div style='width: 800px;'>
  <div id="map" style='width: 800px; height: 400px;'></div>
</div>

<script>
handler = Gmaps.build('Google');
handler.buildMap({ provider: {}, internal: {id: 'map'}}, function(){
  markers = handler.addMarkers([
    {
      "lat": <%= @campaign.latitude %>,
      "lng": <%= @campaign.longitude %>,
      "infowindow": "<%= @campaign.title %>"
    }
  ]);
  handler.bounds.extendWith(markers);
  handler.fitMapToBounds();
});
</script>
<hr>
<% @campaign.rewards.each do |reward| %>
  <div class="col-md-3 well">
    <%= number_to_currency(reward.amount) %>
    <p><%= reward.body %></p>
  </div>
<% end %>
